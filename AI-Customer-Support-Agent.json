{
  "name": "AI Support Assistant",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "filters": {
          "labelIds": [
            "INBOX",
            "UNREAD"
          ]
        }
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.3,
      "position": [
        -192,
        32
      ],
      "id": "011cc989-d162-4b85-8491-731207372fc7",
      "name": "Gmail Trigger",
      "credentials": {
        "gmailOAuth2": {
          "id": "SNZs8guMoYVGLzfc",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "=Gelen mÃ¼ÅŸteri e-postasÄ±nÄ± analiz et ve sÄ±nÄ±flandÄ±r.\n\nE-posta Bilgileri:\n- Kimden: {{ $json.From }}\n- Konu: {{ $json.Subject }}\n- Ä°Ã§erik Ã–zeti: {{ $json.snippet }}\n\nGÃ¶revler:\n1. Konuyu ÅŸu kategorilerden birine ata: [Teknik Destek, Fatura, Ä°ade, SatÄ±ÅŸ, Sistem/UyarÄ±, DiÄŸer].\n2. MÃ¼ÅŸterinin duygu durumunu belirle (KÄ±zgÄ±n, NÃ¶tr, Mutlu).\n3. Aciliyet seviyesini belirle (YÃ¼ksek, Orta, DÃ¼ÅŸÃ¼k).\n\nÃ‡Ä±ktÄ±yÄ± SADECE aÅŸaÄŸÄ±daki JSON formatÄ±nda ver (baÅŸka hiÃ§bir metin ekleme):\n{\n  \"category\": \"Kategori Ä°smi\",\n  \"sentiment\": \"Duygu Durumu\",\n  \"urgency\": \"Aciliyet\",\n  \"reasoning\": \"Neden bu kararÄ± verdiÄŸinin kÄ±sa aÃ§Ä±klamasÄ±\"\n}"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        176,
        16
      ],
      "id": "8005bf8a-c42d-482c-9777-b22c110c6e6e",
      "name": "Message a model",
      "credentials": {
        "googlePalmApi": {
          "id": "mt5QNNfYc8i1Ghj9",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// AI'dan gelen yanÄ±tÄ± alÄ±yoruz\nconst aiResponse = $input.item.json.content.parts[0].text;\nconst cleanJson = aiResponse.replace(/```json/g, \"\").replace(/```/g, \"\").trim();\nconst parsedData = JSON.parse(cleanJson);\n\n// Gmail'den gelen orijinal verileri de (Subject, From vb.) bu pakete ekliyoruz\n// Not: Gmail verisi bir Ã¶nceki node'un \"json\" kÄ±smÄ±nda duruyor olabilir\n// Ancak en garantisi yukarÄ±daki \"Nodes\" menÃ¼sÃ¼nden seÃ§mektir.\n// Åimdilik sadece sÃ¼rÃ¼kle-bÄ±rak yÃ¶ntemini (yukarÄ±daki 1-5 adÄ±mlarÄ±) dene, en temizi odur.\n\nreturn parsedData;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        16
      ],
      "id": "aaaffe58-86ce-4201-8438-cebd73cb5481",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5c6333fc-ea91-4317-af77-4ac7ea9543df",
              "leftValue": "={{ $json.urgency }}",
              "rightValue": "YÃ¼ksek",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        672,
        16
      ],
      "id": "d50c5cbb-3a33-4947-89b6-2cced19a0e08",
      "name": "If"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {
              "content": "=Sen \"TechNova\" teknoloji maÄŸazasÄ±nÄ±n profesyonel MÃ¼ÅŸteri Destek AsistanÄ±sÄ±n.\nAÅŸaÄŸÄ±daki \"Åirket Bilgi BankasÄ±\"nÄ± temel alarak mÃ¼ÅŸteriye yanÄ±t ver. Bilgi bankasÄ±nda cevabÄ± olmayan sorular iÃ§in \"Bu konuda yetkili birime bilgi verdim, size dÃ¶necekler\" de, asla uydurma yapma.\n\n=== ÅÄ°RKET BÄ°LGÄ° BANKASI ===\n1. Ä°ade PolitikasÄ±: ÃœrÃ¼nler, kutusu aÃ§Ä±lmamÄ±ÅŸsa 14 gÃ¼n iÃ§inde koÅŸulsuz iade edilebilir. AÃ§Ä±lmÄ±ÅŸ Ã¼rÃ¼nlerde sadece teknik arÄ±za varsa iade alÄ±nÄ±r. Kargo Ã¼creti bize aittir.\n2. Kargo SÃ¼reci: SipariÅŸler 24 saat iÃ§inde kargoya verilir. YurtiÃ§i Kargo ile Ã§alÄ±ÅŸÄ±yoruz. 1000 TL Ã¼zeri sipariÅŸlerde kargo Ã¼cretsizdir.\n3. Ã‡alÄ±ÅŸma Saatleri: Destek ekibimiz hafta iÃ§i 09:00 - 18:00 arasÄ± Ã§alÄ±ÅŸÄ±r.\n4. Ä°letiÅŸim: Sorun devam ederse destek@technova.com adresinden bize ulaÅŸabilirler.\n==============================\n\nGelen E-posta Ã–zeti: \"{{ $('Gmail Trigger').item.json.snippet }}\"\nKonu: \"{{ $('Gmail Trigger').item.json.Subject }}\"\n\nAnaliz SonuÃ§larÄ±:\n- Kategori: {{ $('Code in JavaScript').item.json.category }}\n- MÃ¼ÅŸteri Duygusu: {{ $('Code in JavaScript').item.json.sentiment }}\nYANIT KURALLARI:\n1. MÃ¼ÅŸteri 'KÄ±zgÄ±n' ise: Ã‡ok nazik, alttan alan ve Ã§Ã¶zÃ¼m odaklÄ± bir dil kullan.\n2. MÃ¼ÅŸteri 'NÃ¶tr' ise: Profesyonel, kÄ±sa ve net ol.\n3. YanÄ±tÄ± TÃ¼rkÃ§e yaz.\n4. Sadece e-posta gÃ¶vdesini (body) ver, konu baÅŸlÄ±ÄŸÄ± yazma.\n5. Ä°mza olarak \"TechNova Destek Ekibi\" kullan.\n6. YanÄ±tÄ± **HTML formatÄ±nda** hazÄ±rla.\n7. Paragraflar iÃ§in <p> etiketi kullan.\n8. Ã–nemli yerleri (Ã¶rneÄŸin 'teknik arÄ±za', '14 gÃ¼n') vurgulamak iÃ§in <b> etiketi ile kalÄ±nlaÅŸtÄ±r.\n9. Maddeler halinde yazman gerekirse <ul> ve <li> etiketlerini kullan.\n10. Asla ```html veya ```json gibi kod bloklarÄ± iÃ§ine alma, sadece saf HTML metni ver.\n11. Ä°mza kÄ±smÄ±nÄ± <br> etiketi ile ayÄ±r.\n...\n\n"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1,
      "position": [
        880,
        144
      ],
      "id": "462e5a2e-7642-4d00-9057-4a73acace390",
      "name": "Message a model1",
      "credentials": {
        "googlePalmApi": {
          "id": "mt5QNNfYc8i1Ghj9",
          "name": "Google Gemini(PaLM) Api account 2"
        }
      }
    },
    {
      "parameters": {
        "chatId": "1959533370",
        "text": "=ğŸš¨ YÃœKSEK ACÄ°LÄ°YETLÄ° E-POSTA ğŸš¨\n\nğŸ“§ Kimden: {{ $('Gmail Trigger').item.json.From }}\nğŸ“Œ Konu: {{ $('Gmail Trigger').item.json.Subject }}\n\nğŸ¤– Kategori: {{ $('Code in JavaScript').item.json.category }}\nâš ï¸ Neden Acil?: {{ $('Code in JavaScript').item.json.reasoning }}\n\nLÃ¼tfen hemen kontrol et!",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [
        896,
        -112
      ],
      "id": "80def9e7-003f-4584-b02d-3641ed4a4a38",
      "name": "Send a text message",
      "webhookId": "f5efca11-16fa-412a-a1e3-3ccd05725fea",
      "credentials": {
        "telegramApi": {
          "id": "7uj3zUZNE1eSEXDm",
          "name": "Telegram account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "c6805b49-86eb-402a-a8c0-d35f9d6ba71b",
              "leftValue": "={{ $json.From }}",
              "rightValue": "no-reply",
              "operator": {
                "type": "string",
                "operation": "notContains"
              }
            },
            {
              "id": "3ee0e137-8764-439b-a533-465cc0599398",
              "leftValue": "={{ $json.From }}",
              "rightValue": "noreply",
              "operator": {
                "type": "string",
                "operation": "notContains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -32,
        32
      ],
      "id": "41523706-c221-4689-a354-01b969e34416",
      "name": "If1"
    },
    {
      "parameters": {
        "sendTo": "={{ $('Gmail Trigger').item.json.From }}",
        "subject": "=Re:  {{ $('Gmail Trigger').item.json.Subject }}",
        "message": "={{ $json.content.parts[0].text }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1168,
        144
      ],
      "id": "7d89deae-ccab-4d54-90d7-af8d54608870",
      "name": "Send a message",
      "webhookId": "c71b68bc-db3c-4fb8-bff8-19f93e71172b",
      "credentials": {
        "gmailOAuth2": {
          "id": "SNZs8guMoYVGLzfc",
          "name": "Gmail account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Gmail Trigger": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Send a text message",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Message a model1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Message a model1": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Message a model",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "c5d41faf-8290-4c2d-82bb-e77bcec4c254",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "81997444f06e690f7f06d28d25d1248ff1e663981384b3f6c12156084d25c3e9"
  },
  "id": "QyG5Y4ag71mkVvNw",
  "tags": []
}